import"./DsnmJJEf.js";import{D as Ge,G as He,p as be,j as t,am as B,f as I,d as L,u as y,s as ie,t as Y,an as X,b as c,c as xe,r as N,al as o,aj as ge,i as $,e as oe,g as x,a as p,h as F,n as Ne,ai as Z,ao as se}from"./D3znixZ8.js";import{p as w,i as g,r as Ve,s as ye}from"./Dr3J8KvJ.js";import{e as Be}from"./DdzsjrDj.js";import{f as Ce,s as re,d as pe,b as Ie,C as Ke,a as qe}from"./DvjnN3xo.js";import{b as Ae}from"./MO0uifOI.js";import{s as ue,i as Se,a as Je}from"./V2q5a4YM.js";import{a as Ee,C as Qe,b as Ze,d as $e}from"./CRGx6HiX.js";import{p as et}from"./Ca2d_0dh.js";import{P as tt}from"./ShooA-cY.js";class we{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(e){this.#n=e}observe(e,a){var d=this.#e.get(e)||new Set;return d.add(a),this.#e.set(e,d),this.#a().observe(e,this.#n),()=>{var u=this.#e.get(e);u.delete(a),u.size===0&&(this.#e.delete(e),this.#t.unobserve(e))}}#a(){return this.#t??(this.#t=new ResizeObserver(e=>{for(var a of e){we.entries.set(a.target,a);for(var d of this.#e.get(a.target)||[])d(a)}}))}}var nt=new we({box:"border-box"});function _e(n,e,a){var d=nt.observe(n,()=>a(n[e]));Ge(()=>(He(()=>a(n[e])),d))}var at=I('<li role="none" class="svelte-1j740zj"><a role="menuitem" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><span class="text svelte-1j740zj"><!></span></div></div></a></li>');function st(n,e){be(e,!0);const a=w(e,"disabled",3,!1),d=w(e,"external_rel",3,"noreferrer"),u=Ee.get();let b=B(void 0);const G=u.add_entry(()=>()=>{t(b)&&t(b).click()},()=>a()),U=y(()=>G.disabled()),O=(i,_=location.host)=>{const D=pe(pe(i,"https://"),"http://");return D.startsWith(_+"/")?pe(D,_):D},f=y(()=>O(e.href)),H=y(()=>!(t(f)[0]==="."||t(f)[0]==="/"&&t(f)[1]!=="/")),V=y(()=>t(H)?d():void 0),C=y(()=>et.url.pathname===e.href);var j=at(),v=L(j);let K;v.__click=function(...i){(t(U)?void 0:()=>u.close())?.apply(this,i)},v.__contextmenu=i=>{i.stopPropagation()};var R=L(v),E=L(R),A=L(E);{var T=i=>{var _=$();Y(()=>oe(_,e.icon)),c(i,_)},P=i=>{var _=x(),D=p(_);{var le=ee=>{var ce=x(),de=p(ce);F(de,()=>e.icon),c(ee,ce)};g(D,ee=>{e.icon&&ee(le)},!0)}c(i,_)};g(A,i=>{typeof e.icon=="string"?i(T):i(P,!1)})}N(E);var s=ie(E,2),m=L(s),z=L(m);{var W=i=>{var _=x(),D=p(_);F(D,()=>e.children),c(i,_)},S=i=>{var _=$();Y(()=>oe(_,t(f))),c(i,_)};g(z,i=>{e.children?i(W):i(S,!1)})}N(m),N(s),N(R),N(v),Ae(v,i=>o(b,i),()=>t(b)),N(j),Y(()=>{K=Ce(v,1,"menu_item plain svelte-1j740zj",null,K,{selected:t(C),disabled:t(U)}),re(v,"aria-disabled",t(U)),re(v,"href",e.href),re(v,"rel",t(V))}),X("mouseenter",v,function(...i){(t(U)?void 0:_=>{ue(_),u.select(G)})?.apply(this,i)}),c(n,j),xe()}ge(["click","contextmenu"]);var rt=I('<li role="menuitem" aria-label="contextmenu entry" tabindex="-1"><div class="content"><div class="icon"><!></div> <div class="title"><!></div> <!></div></li>');function it(n,e){be(e,!0);const a=w(e,"disabled",3,!1),d=Ee.get(),u=d.add_entry(()=>e.run,()=>a()),b=y(()=>u.selected),G=y(()=>u.pending),U=y(()=>u.error_message),O=y(()=>u.disabled());var f=rt();let H;f.__click=function(...s){(t(O)?void 0:()=>{setTimeout(()=>d.activate(u))})?.apply(this,s)};var V=L(f),C=L(V),j=L(C);{var v=s=>{var m=$();Y(()=>oe(m,e.icon)),c(s,m)},K=s=>{var m=x(),z=p(m);{var W=S=>{var i=x(),_=p(i);F(_,()=>e.icon),c(S,i)};g(z,S=>{e.icon&&S(W)},!0)}c(s,m)};g(j,s=>{typeof e.icon=="string"?s(v):s(K,!1)})}N(C);var R=ie(C,2),E=L(R);F(E,()=>e.children),N(R);var A=ie(R,2);{var T=s=>{tt(s,{})},P=s=>{var m=x(),z=p(m);{var W=S=>{var i=$("⚠️");c(S,i)};g(z,S=>{t(U)&&S(W)},!0)}c(s,m)};g(A,s=>{t(G)?s(T):s(P,!1)})}N(V),N(f),Y(()=>{H=Ce(f,1,"menu_item plain selectable deselectable svelte-v5v3d3",null,H,{selected:t(b),disabled:t(O)}),re(f,"aria-disabled",t(O)),re(f,"title",t(U)?`Error: ${t(U)}`:void 0)}),X("mouseenter",f,function(...s){(t(O)?void 0:m=>{ue(m),d.select(u)})?.apply(this,s)}),c(n,f),xe()}ge(["click"]);function ot(n,e){it(n,{get run(){return e.run},icon:d=>{Ne();var u=$();Y(()=>oe(u,e.icon)),c(d,u)},children:(d,u)=>{Ne();var b=$();Y(()=>oe(b,e.content)),c(d,b)},$$slots:{icon:!0,default:!0}})}var lt=I("<li></li>");function ct(n,e){const a=Ve(e,["$$slots","$$events","$$legacy"]);var d=lt();Ie(d,()=>({role:"separator","aria-orientation":"vertical",...a,[Ke]:{contextmenu_separator:!0}}),void 0,void 0,void 0,"svelte-1muwcg0"),c(n,d)}const dt=-2,_t=-2,ut=750,vt=11,Dt=633,Ft=21,Oe=(n,e)=>!e&&(n instanceof HTMLElement||n instanceof SVGElement)&&!Se(n)&&!Je(n),ft=n=>new Map([["Escape",()=>n.close()],["ArrowLeft",()=>n.collapse_selected()],["ArrowRight",()=>n.expand_selected()],["ArrowDown",()=>n.select_next()],["ArrowUp",()=>n.select_previous()],["Home",()=>n.select_first()],["End",()=>n.select_last()],[" ",()=>n.activate_selected()],["Enter",()=>n.activate_selected()]]),mt=n=>e=>{const a=n.get(e.key);!a||Se(e.target)||(ue(e),a())},ht=(n,e,a)=>n+Math.min(0,a-(n+e)),pt=(n,e,a)=>n+Math.min(0,a-(n+e)),bt=(n,e=Z)=>{st(n,ye(e))},xt=(n,e=Z)=>{ot(n,ye(e))},gt=(n,e=Z)=>{ct(n,ye(e))};var yt=I('<div class="contextmenu_root svelte-1m4rj9b" role="region"><!></div>'),Et=I('<div class="contextmenu_layout svelte-1m4rj9b" aria-hidden="true"></div>'),wt=I('<ul class="contextmenu unstyled pane svelte-1m4rj9b" role="menu" aria-label="context menu" tabindex="-1"></ul>'),Tt=I("<!> <!>  <!>",1);function Pt(n,e){be(e,!0);const a=w(e,"contextmenu",19,()=>new Qe),d=w(e,"open_offset_x",3,dt),u=w(e,"open_offset_y",3,_t),b=w(e,"bypass_with_tap_then_longpress",3,!0),G=w(e,"bypass_window",3,ut),U=w(e,"bypass_move_tolerance",3,vt),O=w(e,"scoped",3,!1),f=w(e,"link_entry",3,bt),H=w(e,"text_entry",3,xt),V=w(e,"separator_entry",3,gt);Ee.set(a());let C=B(void 0);const j=y(()=>a().layout),v=Ze.set(),K=y(()=>ht(a().x,v.width,t(j).width)),R=y(()=>pt(a().y,v.height,t(j).height));let E=B(void 0),A=B(void 0),T=B(void 0),P=B(void 0),s=B(void 0);const m=r=>{if(t(P)){o(P,!1),o(T,null),o(E,null),o(A,null),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}const{target:l}=r;Oe(l,r.shiftKey)&&(t(C)?.contains(l)||$e(l,r.clientX+d(),r.clientY+u(),a(),{link_enabled:f()!==null,text_enabled:H()!==null,separator_enabled:V()!==null})&&ue(r))},z=r=>{if(!b())return;const{touches:l,target:k}=r;if(a().opened||l.length!==1||!Oe(k,r.shiftKey)){o(T,null),o(E,null),o(A,null),o(P,!1),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}const{clientX:h,clientY:M}=l[0];if(t(T)!=null&&performance.now()-t(T)<G()&&Math.hypot(h-t(E),M-t(A))<U()){o(P,!0),o(T,null),o(E,null),o(A,null),t(s)!=null&&(clearTimeout(t(s)),o(s,null));return}o(T,performance.now(),!0),o(E,h,!0),o(A,M,!0),t(s)!=null&&clearTimeout(t(s)),o(s,setTimeout(()=>{o(T,null),o(E,null),o(A,null),o(s,null)},G()),!0)},W=()=>{o(T,null),o(E,null),o(A,null),o(P,!1),t(s)!=null&&(clearTimeout(t(s)),o(s,null))},S=r=>{t(C)&&!t(C).contains(r.target)&&a().close()},i=y(()=>ft(a())),_=y(()=>mt(t(i)));var D=Tt();X("contextmenu",se,function(...r){(O()?void 0:m)?.apply(this,r)}),X("mousedown",se,function(...r){(a().opened?S:void 0)?.apply(this,r)}),X("keydown",se,function(...r){(a().opened?t(_):void 0)?.apply(this,r)}),X("touchstart",se,function(...r){(O()||!b()?void 0:z)?.apply(this,r)},!0,!0),X("touchcancel",se,function(...r){(O()||!b()?void 0:W)?.apply(this,r)},!0);var le=p(D);{var ee=r=>{var l=yt();l.__contextmenu=m;var k=L(l);F(k,()=>e.children),N(l),X("touchstart",l,function(...h){(b()?z:void 0)?.apply(this,h)},!0,!0),X("touchcancel",l,function(...h){(b()?W:void 0)?.apply(this,h)},!0),c(r,l)},ce=r=>{var l=x(),k=p(l);F(k,()=>e.children),c(r,l)};g(le,r=>{O()?r(ee):r(ce,!1)})}var de=ie(le,2);{var Me=r=>{var l=Et();_e(l,"clientWidth",k=>t(j).width=k),_e(l,"clientHeight",k=>t(j).height=k),c(r,l)};g(de,r=>{a().has_custom_layout||r(Me)})}var Le=ie(de,2);{var Ue=r=>{var l=wt();let k;Be(l,20,()=>a().params,h=>h,(h,M)=>{var Te=x(),je=p(Te);{var De=q=>{var te=x(),ve=p(te);F(ve,()=>M),c(q,te)},Fe=q=>{var te=x(),ve=p(te);{var Pe=J=>{var ne=x(),fe=p(ne);F(fe,()=>f()??Z,()=>M.props),c(J,ne)},Xe=J=>{var ne=x(),fe=p(ne);{var Re=Q=>{var ae=x(),me=p(ae);F(me,()=>H()??Z,()=>M.props),c(Q,ae)},ze=Q=>{var ae=x(),me=p(ae);{var We=he=>{var ke=x(),Ye=p(ke);F(Ye,()=>V()??Z,()=>M.props),c(he,ke)};g(me,he=>{M.snippet==="separator"&&he(We)},!0)}c(Q,ae)};g(fe,Q=>{M.snippet==="text"?Q(Re):Q(ze,!1)},!0)}c(J,ne)};g(ve,J=>{M.snippet==="link"?J(Pe):J(Xe,!1)},!0)}c(q,te)};g(je,q=>{typeof M=="function"?q(De):q(Fe,!1)})}c(h,Te)}),N(l),Ae(l,h=>o(C,h),()=>t(C)),Y(()=>k=qe(l,"",k,{transform:`translate3d(${t(K)??""}px, ${t(R)??""}px, 0)`})),_e(l,"offsetWidth",h=>v.width=h),_e(l,"offsetHeight",h=>v.height=h),c(r,l)};g(Le,r=>{a().opened&&r(Ue)})}c(n,D),xe()}ge(["contextmenu"]);export{Pt as C,Ft as a,Dt as b,ut as c,vt as d,dt as e,_t as f,st as g,ot as h,ct as i,Oe as j,mt as k,ft as l,_e as m,ht as n,pt as o,it as p};
